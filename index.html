<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAT - BRAZIL</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        border: 0;
        box-sizing: border-box;
    }

    main {
        width: 100vw;
        height: 100vh;
        background-color: #D0CA92;
    }

    .map {
        display: flex;
        justify-content: center;
        position: relative;
        width: 100%;
    }

    .brazil {
        width: 100%;
        height: 100%;
        position: relative;
        width: 100%;
        transition: 1s ease;
        transform-origin: 700px 600px;
    }

    .boneco {
        height: 100px;
        position: absolute;
    }

    .stand {
        position: absolute;
        width: 50px;
        height: 50px;
        right: 700px;
        bottom: 130px;
        display: flex;
        justify-content: center;
    }

    .mark-atual{
        width: 50px;
        height: 50px;
    }

    .zoom{
        transform: scale(4.5);
    }
</style>

<body>
    <main class="map">
        <div class="brazil-map">
            <img class="brazil" src="/public/assets/images/bg-main.svg" alt="Mapa brasil">

            <div class="stand bat-atual" data-jogo="kaban" data-link="/src/pages/kaban1.html">
                <img src="./public/assets/images/makr.svg" alt="marcacao" class="mark-atual" />
                
            </div>

            <img src="./public/assets/images/player-right-front.svg" alt="player" id="boneco" class="boneco"
                style="top: 400px; left: 400px;" />
        </div>
        <audio style="position: absolute; left: 80px; top: 8px;" src="/public/assets/audios/bg-music-epic1.mp3" autoplay loop controls></audio>
    </main>
</body>

<script>
    const boneco = document.getElementById('boneco');
    const stands = document.querySelectorAll('.stand');
    const brazil = document.querySelector(".brazil")

    let posX = 400;
    let posY = 400;

    document.addEventListener('keydown', (e) => {
        switch (e.key) {
            case 'ArrowUp': posY -= 30;
                boneco.setAttribute("src", "/public/assets/images/player-left.svg");
                audioPlay("walk")
                break;
            case 'ArrowDown': posY += 30;
                boneco.setAttribute("src", "/public/assets/images/player-right-front.svg");
                audioPlay("walk")
                break;
            case 'ArrowLeft': posX -= 30;
                boneco.setAttribute("src", "/public/assets/images/player-left-front.svg");
                audioPlay("walk")
                break;
            case 'ArrowRight': posX += 30;
                boneco.setAttribute("src", "/public/assets/images/player-right.svg");
                audioPlay("walk")
                break;
        }
        boneco.style.top = posY + 'px';
        boneco.style.left = posX + 'px';
        verificarProximidade();
    });

    function verificarProximidade() {
        jogoAtual = null;

        stands.forEach(stand => {
            const standRect = stand.getBoundingClientRect();
            const bonecoRect = boneco.getBoundingClientRect();

            const distancia = Math.hypot(
                standRect.left - bonecoRect.left,
                standRect.top - bonecoRect.top
            );

            if (distancia < 80) {
                console.log(stand)
                jogoAtual = stand.dataset.link;
                audioPlay("yeah")
                brazil.classList.add("zoom")
                setTimeout(() => {
            window.location.href = '/src/pages/rpg-factory.html';
        }, 3000);
            }
        });
    }

    function audioPlay(song) {
        const audio = new Audio(`/public/assets/audios/${song}.mp3`);
        audio.play();
    }
</script>

</html>